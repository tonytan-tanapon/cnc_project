<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Materials · Topnotch MFG</title>
  <link rel="stylesheet" href="/static/css/app.css" />
</head>
<body>
  <div class="app">
    <!-- Sidebar (โหลดจาก partial เพื่อลดการพิมพ์ซ้ำ) -->
    <aside class="sidebar" data-include="/static/partials/nav.html"></aside>

    <!-- Main -->
    <main class="main">
      <!-- Topbar -->
      <div class="topbar">
        <div class="search">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zM9.5 14C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
          </svg>
          <input id="globalSearch" type="search" placeholder="Search…" />
        </div>
        <input id="apiBase" placeholder="API Base (default /api/v1)" />
        <button class="btn" id="btnPing" type="button">Ping</button>
      </div>

      <!-- Page -->
      <section>
        <h2 class="page-title">🧱 Materials & Batches</h2>

        <div class="grid">
          <div class="col-6">
            <div class="card">
              <b>Create Material</b>
              <div class="grid" style="margin-top:8px">
                <div class="col-6"><label>Code</label><input id="m_code" placeholder="AL6061" /></div>
                <div class="col-6"><label>Name</label><input id="m_name" placeholder="Aluminium 6061" /></div>
                <div class="col-6"><label>Spec</label><input id="m_spec" placeholder="AMS/ASTM" /></div>
                <div class="col-6"><label>UoM</label><input id="m_uom" value="kg" /></div>
                <div class="col-12"><label>Remark</label><input id="m_remark" /></div>
                <div class="col-12">
                  <button class="btn" id="m_create" type="button">Create</button>
                  <span class="hint">POST /materials</span>
                </div>
              </div>
              <div class="toolbar"><button class="btn" id="m_reload" type="button">Reload</button></div>
              <div id="m_table"></div>
            </div>
          </div>

          <div class="col-6">
            <div class="card">
              <b>Create Batch</b>
              <div class="grid" style="margin-top:8px">
                <div class="col-6"><label>Material ID</label><input id="b_mid" type="number" /></div>
                <div class="col-6"><label>Batch No.</label><input id="b_no" placeholder="B-24001" /></div>
                <div class="col-6"><label>Supplier ID</label><input id="b_sid" type="number" /></div>
                <div class="col-6"><label>Qty Received</label><input id="b_qty" type="number" step="0.001" value="0" /></div>
                <div class="col-6"><label>Location</label><input id="b_loc" placeholder="RACK-A1" /></div>
                <div class="col-6"><label>Received Date</label><input id="b_recv" type="date" /></div>
                <div class="col-12">
                  <button class="btn" id="b_create" type="button">Create</button>
                  <span class="hint">POST /batches</span>
                </div>
              </div>
              <div class="toolbar"><button class="btn" id="b_reload" type="button">Reload</button></div>
              <div id="b_table"></div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Toast (api.js จะสร้างให้อัตโนมัติถ้าไม่มีอันนี้) -->
  <div class="toast" id="toast" role="status" aria-live="polite"><span id="toastText"></span></div>

  <!-- โหลด nav partial + ทำ active + init topbar -->
  <script type="module">
    // inject sidebar nav
    const side = document.querySelector('.sidebar[data-include]');
    if (side) {
      fetch(side.getAttribute('data-include'))
        .then(r => r.text())
        .then(html => {
          side.innerHTML = html;
          import('/static/js/nav-active.js?v=1').then(m => m.activateCurrentNav && m.activateCurrentNav());
        })
        .catch(()=>{});
    }
    // init topbar
    import('/static/js/api.js?v=4').then(m => m.initTopbar && m.initTopbar());
  </script>

  <!-- หน้า Materials -->
  <script type="module" src="/static/js/page-material.js?v=1"></script>
</body>
</html>
