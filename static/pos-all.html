<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>POs · Topnotch – MFG</title>
    <link rel="stylesheet" href="/static/css/app.css" />
    <style>
      :root {
        --list-w: min(560px, 46vw);
      }

      .split-2col {
        display: grid;
        grid-template-columns: var(--list-w) 12px 1fr; /* left | resizer | right */
        gap: 16px;
        min-height: calc(100vh - 220px);
      }
      .split-2col > .panel {
        min-width: 0;
      }
      .split-resizer {
        width: 12px;
        cursor: col-resize;
        background: linear-gradient(180deg, #eef2f7, #f8fafc);
        border: 1px solid #e5e7eb;
        border-radius: 8px;
      }
      @media (max-width: 960px) {
        .split-2col {
          grid-template-columns: 1fr;
        }
        .split-resizer {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <div class="app">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="logo">
          <span class="logo-badge">TN</span><span>Topnotch – MFG</span>
        </div>
        <div id="navSlot" data-nav-slot></div>
      </aside>

      <!-- Main -->
      <main class="main">
        <!-- Topbar -->
        <div class="topbar">
          <div class="search">
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="currentColor"
              aria-hidden="true"
            >
              <path
                d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zM9.5 14C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
              />
            </svg>
            <input
              id="globalSearch"
              type="search"
              placeholder="Search PO / Lot / Tracking…"
            />
          </div>
          <input
            id="apiBase"
            value="/api/v1"
            placeholder="API Base (ว่าง = /api/v1)"
            aria-label="API Base"
          />
          <button class="btn" id="btnPing" type="button">Ping</button>
        </div>

        <!-- Page header -->
        <section
          class="page-header"
          style="display: flex; align-items: center; gap: 8px; margin-top: 6px"
        >
          <h2 class="page-title" style="margin: 0">📦 Purchase Orders</h2>
          <button id="po_reload" class="btn-small secondary" type="button">
            Reload
          </button>
        </section>

        <!-- Split: Detail (left) | Lines (right) -->
        <div class="split-2col">
          <!-- LEFT: PO Detail -->
          <section class="panel" id="detailPanel">
            <!-- PO search (เลือก PO เพื่อโหลดรายละเอียด) -->
            <div class="list-topbar">
              <input
                id="po_search"
                type="search"
                class="search-lg"
                placeholder="Search PO (number / customer)…"
              />
              <button id="po_btnNew" class="btn-small" type="button">
                New
              </button>
            </div>

            <!-- Detail header -->
            <div class="detail-head">
              <div>
                <h3 style="margin: 0">Details</h3>
                <div id="po_subTitle" class="muted">—</div>
              </div>
              <div style="display: flex; gap: 6px; align-items: center">
                <span id="po_hint" class="muted"></span>
                <button
                  id="po_btnEdit"
                  class="btn-small secondary"
                  type="button"
                >
                  Edit
                </button>
                <button
                  id="po_btnSave"
                  class="btn-small"
                  type="button"
                  style="display: none"
                >
                  Save
                </button>
                <button
                  id="po_btnCancel"
                  class="btn-small secondary"
                  type="button"
                  style="display: none"
                >
                  Cancel
                </button>
              </div>
            </div>

            <!-- Detail body -->
            <div class="detail-body">
              <div id="po_error" class="muted" style="display: none"></div>
              <div
                id="po_view"
                class="kv-list"
                title="Double-click a row to edit"
              ></div>
            </div>

            <!-- Detail footer -->
            <div class="detail-footer">
              <button
                id="po_btnDelete"
                class="btn-small btn-danger"
                type="button"
              >
                Delete
              </button>
            </div>
          </section>

          <!-- RESIZER -->
          <div
            id="splitResizer"
            class="split-resizer"
            role="separator"
            aria-orientation="vertical"
            aria-label="Resize panels"
          ></div>

          <!-- RIGHT: PO Lines -->
          <section class="panel" id="linesPanel">
            <div class="detail-head">
              <div class="title">Lines</div>
              <div>
                <button id="btnAddLine" type="button" class="btn-small">
                  + Add Line
                </button>
              </div>
            </div>
            <div class="detail-body" style="padding: 0">
              <table class="grid lines-table">
                <colgroup>
                  <col style="width: 64px" />
                  <col style="width: 200px" />
                  <col style="width: 160px" />
                  <col style="width: 120px" />
                  <col style="width: 140px" />
                  <col style="width: 160px" />
                  <col />
                  <col style="width: 180px" />
                </colgroup>
                <thead>
                  <tr>
                    <th style="text-align: right">No.</th>
                    <th>Part No.</th>
                    <th>Revision</th>
                    <th style="text-align: right">Qty</th>
                    <th style="text-align: right">Unit Price</th>
                    <th>Due</th>
                    <th>Notes</th>
                    <th style="text-align: right">Actions</th>
                  </tr>
                </thead>
                <tbody id="tblLinesBody"></tbody>
              </table>
            </div>
          </section>
        </div>
      </main>
    </div>

    <div class="toast" id="toast" role="status" aria-live="polite">
      <span id="toastText"></span>
    </div>

    <script type="module" src="/static/js/nav-loader.js"></script>
    <script type="module" src="/static/js/page-pos-all.js?v=3"></script>
  </body>
</html>
