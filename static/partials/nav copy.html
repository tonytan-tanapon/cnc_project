<div class="logo">
  <span id="toggleNav" class="toggle-btn logo-badge">TN</span>
  <!-- ğŸ‘‡ à¹€à¸à¸´à¹ˆà¸¡à¸ªà¹ˆà¸§à¸™à¸Šà¸·à¹ˆà¸­à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¹à¸¥à¸° logout -->
  <span id="userInfo" class="user-info"></span>
</div>

<nav class="nav" id="sidebar" aria-label="Primary">
  <a href="/static/index.html"
    ><span class="icon">ğŸ </span><span class="label">Dashboard</span></a
  >
  Reports
  <a href="/static/manage-pos.html"
    ><span class="icon">ğŸ§©</span><span class="label">Manage POS</span></a
  >
  <a href="/static/manage-parts.html"
    ><span class="icon">ğŸ§©</span><span class="label">Manage Parts</span></a
  >
  <a href="/static/manage-lot-shipment-status.html"
    ><span class="icon">ğŸ§©</span><span class="label">View Shipment</span></a
  >

  Manage data
  <a href="/static/pos.html"
    ><span class="icon">ğŸ“¦</span><span class="label">Purchase Orders</span></a
  >
  <a href="/static/parts.html"
    ><span class="icon">âš™ï¸</span><span class="label">Parts/Rev</span></a
  >
  <a href="/static/lots.html"
    ><span class="icon">ğŸ—‚ï¸</span><span class="label">Lots</span></a
  >
  <a href="/static/travelers.html"
    ><span class="icon">ğŸ§¾</span><span class="label">Travelers</span></a
  >
  <a href="/static/batches.html"
    ><span class="icon">ğŸ“š</span><span class="label">Batches</span></a
  >
  <a href="/static/manage-shipments.html"
    ><span class="icon">ğŸ§¾</span><span class="label">Shipment</span></a
  >

  Setting
  <a href="/static/customers.html"
    ><span class="icon">ğŸ‘¥</span><span class="label">Customers</span></a
  >
  <a href="/static/materials.html"
    ><span class="icon">ğŸ§±</span><span class="label">Materials</span></a
  >
  <a href="/static/suppliers.html"
    ><span class="icon">ğŸ­</span><span class="label">Suppliers</span></a
  >
  <a href="/static/subcon.html"
    ><span class="icon">ğŸ¤</span><span class="label">Subcontracting</span></a
  >
  <a href="/static/employees.html"
    ><span class="icon">ğŸ§‘â€ğŸ­</span><span class="label">Employees</span></a
  >
  <a href="/static/users.html"
    ><span class="icon">ğŸ‘¤</span><span class="label">Users</span></a
  >

  Payroll
  <a href="/static/payroll.html"
    ><span class="icon">ğŸ’µ</span><span class="label">Payrolls</span></a
  >
  <a href="/static/time_clock.html"
    ><span class="icon">â±ï¸</span><span class="label">Time clock</span></a
  >

  UI traveler
  <a href="/static/ui-traveler.html"
    ><span class="icon">ğŸ’µ</span><span class="label">UI Traveler</span></a
  >
</nav>

<style>
  .logo {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: #2563eb;
    color: #fff;
    padding: 10px 16px;
    font-weight: 600;
  }
  .user-info {
    font-size: 14px;
    color: #fff;
  }
  .user-info a {
    color: #fff;
    text-decoration: underline;
    margin-left: 8px;
  }
</style>

<script type="module">
  import { jfetch, toast } from "/static/js/api.js";

  const userInfo = document.getElementById("userInfo");

  async function loadUser() {
    const token = localStorage.getItem("token");
    if (!token) {
      userInfo.innerHTML = `<a href="/static/login.html">Login</a>`;
      return;
    }
    try {
      const user = await jfetch("/auth/me");
      userInfo.innerHTML = `
        ğŸ‘‹ ${user.username}
        <a href="#" id="logoutLink">Logout</a>
      `;
      document.getElementById("logoutLink").addEventListener("click", logout);
    } catch {
      // à¸–à¹‰à¸² token à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸
      localStorage.removeItem("token");
      userInfo.innerHTML = `<a href="/static/login.html">Login</a>`;
    }
  }

  function logout() {
    localStorage.removeItem("token");
    toast("Logged out");
    setTimeout(() => (window.location.href = "/static/login.html"), 800);
  }

  loadUser();
</script>
